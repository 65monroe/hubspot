#!/usr/bin/env ruby
require './config'

rake = Rake.application
rake.init
rake.load_rakefile

rake['db:drop'].invoke
rake['db:create'].invoke
rake['db:migrate'].invoke
rake['db:seed'].invoke

# TODO: update this to allow for passing of
# options on run
%w(Companies Contacts Deals Engagements Owners).each do |hub_data|
  "Api::#{hub_data}".constantize.new.retreive
  puts "== #{hub_data} Done =="
end

# create a new excel chart with our newly acquired data
Excel::Workbook.new

# send an email with our newly created workbook
rake['email:send'].invoke
#!/usr/bin/env ruby
require './config'

rake = Rake.application
rake.init
rake.load_rakefile

rake['db:drop'].invoke
rake['db:create'].invoke
rake['db:migrate'].invoke
rake['db:seed'].invoke

# TODO: update this to allow for passing of
# options on run
%w(Companies Contacts Deals Engagements Owners).each do |hub_data|
  "Api::#{hub_data}".constantize.new.retreive
  puts "== #{hub_data} Done =="
end
  
# create new master tables for OBDC driver access
# FOR JOSH 
Contact.all.each do |contact|
  params = MasterTable::ContactParams.new(contact)
  MasterContact.create(params.valid_params)
end

Deal.all.each do |deal|
  params = MasterTable::DealParams.new(deal)
  MasterDeal.create(params.valid_params)
end